<!Doctype html>
<html>
    <head>
        <link rel="stylesheet" type="text/css" href="index.css">
    </head>
    <body>
        <h1 class="banner" id="market">Market</h1>

        <div class="login">
            <input type="email" placeholder="email" name="email" id="email" required> <br><br>
            <input type="password" placeholder="password" name="psw" id="password" required> <br><br>
            <Button variant="primary" type="submit" onclick="login()">Login</Button>  <Button type="submit" onclick="signup()">Sign up</Button>
        </div>

        <script>

            async function login(){
                email = document.getElementById('email').value
                password = document.getElementById('password').value

                const url = "http://localhost:5500/login"
                const headers = {"Content-Type" : "application/json; charset=utf-8"}
                const body = { email: email, password: password}
                
                try {   

                    const res = await fetch(url, {
                        method : "POST", 
                        mode: "cors", 
                        headers : headers, body : 
                        JSON.stringify(body)
                    })

                    const data = await res.json()

                    if (data["token"]) {
                        // CREATE COOKIE FOR USER
                        document.cookie = "market_token="+data['token'] 
                        location.replace("/dashboard")
                    }

                } catch(err) {
                    alert("Failure to login")
                }
            }

            function signup(){
                location.replace("/signup")
            }


        </script>


    </body>
</html>